---
title: '6372: Project 1'
author: "Megan Ball, Matt Farrow, Neddy Nyatome"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(reshape2)
library(knitr)
library(scales)
library(corrplot)
```

## Introduction

## Data Description

Description and context of the Life Expectancy (WHO) dataset can be found [here](https://www.kaggle.com/kumarajarshi/life-expectancy-who).

|Field|Description|
|---:|:---|
|Country|Country|
|Year|Year|
|Status|Developed or Developing status|
|Life expectancy|Life Expectancy in age|
|Adult Mortality|Adult Mortality Rates of both sexes (probability of dying between 15 and 60 years per 1000 population)|
|infant deaths|Number of Infant Deaths per 1000 population|
|Alcohol|Alcohol, recorded per capita (15+) consumption (in litres of pure alcohol)|
|percentage expenditure|Expenditure on health as a percene of Gross Domestic Product per capita(%)|
|Hepatitis B|Hepatitis B (HepB) immunization coverage among 1-year-olds (%)|
|Measles|Measles - number of reported cases per 1000 population|
|BMI|Average Body Mass Index of entire population|
|under-five deaths|Number of under-five deaths per 1000 population|
|Polio|Polio (Pol3) immunization coverage among 1-year-olds (%)|
|Total expenditure|General government expenditure on health as a percene of total government expenditure (%)|
|Diphtheria|Diphtheria tetanus toxoid and pertussis (DTP3) immunization coverage among 1-year-olds (%)|
|HIV/AIDS|Deaths per 1 000 live births HIV/AIDS (0-4 years)|
|GDP|Gross Domestic Product per capita (in USD)|
|Population|Population of the country|
|thinness 1-19 years|Prevalence of thinness among children and adolescents for Age 10 to 19 (%)|
|thinness 5-9 years|Prevalence of thinness among children for Age 5 to 9(%)|
|Income composition of resources|Income composition of resources|
|Schooling|Number of years of Schooling(years)|

Data dictionary courtesy [Steve Ziring](https://www.kaggle.com/steveziring)

```{r load-data}
# Load data
df <- read_csv(here::here("data - raw", "Life Expectancy Data.csv"))

# Clean up column names
df <- janitor::clean_names(df)

# Several different ways of getting a high-level look at the data
summary(df)
glimpse(df)
Hmisc::describe(df)
psych::describe(df)
skimr::skim(df)
```

## Exploratory Data Analysis

```{r}
# Histograms
ggplot(melt(df), aes(value)) +
  geom_histogram() +
  facet_wrap(~ variable, scales = "free")

# Pct NA in each variable
df_pct_na <- df %>% 
  select_if(function(x) any(is.na(x))) %>% 
  summarise_each(funs((sum(is.na(.)) / 2938))) %>% 
  pivot_longer(cols = everything(), names_to = "variable", values_to = "pct") %>% 
  mutate(pct = percent(pct))
```

```{r}
# Correlation Analysis

# Drop categorical columns
df_corr <- df %>% 
  select(-c(country, status))

# Four different ways to visualize
corrplot(cor(df_corr, use = "complete.obs"), method = "circle")
corrplot(cor(df_corr, use = "complete.obs"), method = "pie")
corrplot(cor(df_corr, use = "complete.obs"), method = "color")
corrplot(cor(df_corr, use = "complete.obs"), method = "number")

# Pairs plot
GGally::ggpairs(df_corr, alpha = 0.5)
ggsave("ggpairs.png", width = 17, height = 11, units = "in", dpi = "retina")
```

```{r}
# VIF analysis
library(car)
full_model <- lm(life_expectancy ~ ., data = df_corr)
full_model_vif <- vif(full_model)
full_model_vif <- tibble(variable = names(full_model_vif), vif = full_model_vif)
```


```{r}
# EDA
df %>% 
  ggplot(aes(life_expectancy, schooling)) +
  geom_point(alpha = 0.4) +
  labs(title = "Life Expectancy EDA") +
  theme_minimal()

df %>% 
  ggplot(aes(life_expectancy, income_composition_of_resources)) +
  geom_point(alpha = 0.4) +
  labs(title = "Life Expectancy EDA") +
  theme_minimal()

df %>% 
  ggplot(aes(life_expectancy, log(hiv_aids))) +
  geom_point(alpha = 0.4) +
  labs(title = "Life Expectancy EDA") +
  theme_minimal()

df %>% 
  ggplot(aes(life_expectancy, reorder(country, life_expectancy))) +
  geom_boxplot() +
  geom_jitter(alpha = 0.2) +
  facet_wrap(~ status, scales = "free") +
  theme_minimal()
```



## Objective 1

### Restatement of Problem and the Overall Approach to Solve It

### Model Selection

#### Type of Selection

- LASSO
- RIDGE
- ELASTIC NET
- Stepwise
- Forward
- Backward
- Manual / Intuition
- A mix of all of the above

#### Checking Assumptions

- Residual Plots
- Influential point analysis (Cook’s D and Leverage)

#### Compare Competing Models

Via:  Training and test set split or CV
Possible Metrics: ASE (Required), AIC, BIC, adj R2, are all welcome additions
	
#### Parameter Interpretation (Simple model only)

- Interpretation 
- Confidence Intervals

#### Additional Details on a more complicated regression model 

## Objective 2 Deliverable (see above)
	
Final conclusions from the analyses of Objective 1’s interpretable model and include comments on what model would be recommended if prediction was the only goal (comparing all models considered).  

## Appendix 

- Well-commented SAS/R Code
- Graphics and summary tables (Can be placed in the appendix or in the written report itself.)
